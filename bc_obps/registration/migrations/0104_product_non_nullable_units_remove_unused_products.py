# Generated by Django 5.0.13 on 2025-04-11 17:10

from django.db import migrations, models


def add_unregulated_line_tracing_product(apps, schema_editor):
    RegulatedProduct = apps.get_model('registration', 'RegulatedProduct')

    RegulatedProduct.objects.create(
        name='Refineries line tracing',
        is_regulated=False,
    )


def reverse_add_unregulated_line_tracing_product(apps, schema_editor):
    RegulatedProduct = apps.get_model('registration', 'RegulatedProduct')

    RegulatedProduct.objects.filter(
        name='Mining: critical mineral, other than copper',
    ).delete()
    RegulatedProduct.objects.filter(
        name='Smelting: critical mineral, other than aluminun and lead-zinc',
    ).delete()
    RegulatedProduct.objects.filter(
        name='Refineries line tracing',
    ).delete()


def remove_unused_products(apps, schema_editor):
    RegulatedProduct = apps.get_model('registration', 'RegulatedProduct')

    RegulatedProduct.objects.filter(
        name='Smelting: critical mineral, other than aluminun and lead-zinc',
    ).delete()
    RegulatedProduct.objects.filter(
        name='Mining: critical mineral, other than copper',
    ).delete()


def reverse_remove_unused_products(apps, schema_editor):
    RegulatedProduct = apps.get_model('registration', 'RegulatedProduct')

    RegulatedProduct.objects.create(
        name='Smelting: critical mineral, other than aluminun and lead-zinc',
        is_regulated=True,
    )
    RegulatedProduct.objects.create(
        name='Mining: critical mineral, other than copper',
        is_regulated=True,
    )


class Migration(migrations.Migration):

    dependencies = [
        ('registration', '0103_historicaluser_archived_at_and_more'),
    ]

    operations = [
        migrations.AlterField(
            model_name='historicalregulatedproduct',
            name='unit',
            field=models.CharField(
                db_comment='The unit of measure for a regulated product', default='N/A', max_length=1000
            ),
        ),
        migrations.AlterField(
            model_name='regulatedproduct',
            name='unit',
            field=models.CharField(
                db_comment='The unit of measure for a regulated product', default='N/A', max_length=1000
            ),
        ),
        migrations.AddConstraint(
            model_name='regulatedproduct',
            constraint=models.UniqueConstraint(fields=('name', 'unit'), name='unique_product_on_name_unit'),
        ),
        migrations.RunPython(add_unregulated_line_tracing_product, reverse_add_unregulated_line_tracing_product),
        migrations.RunPython(remove_unused_products, reverse_remove_unused_products),
    ]
