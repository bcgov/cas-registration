# Generated by Django 5.0.13 on 2025-03-26 16:04
from django.db import migrations
from datetime import datetime
from zoneinfo import ZoneInfo


"""
One-time forward-only migration to be applied to prod data.
Purpose: Create a new OperationDesignatedOperatorTimeline record for each Operation record in the database.
"""


def populate_operation_timeline_table_with_existing_data(apps, schema_editor):
    Operation = apps.get_model("registration", "Operation")
    OperationDesignatedOperatorTimeline = apps.get_model("registration", "OperationDesignatedOperatorTimeline")


    for operation in Operation.objects.all():
        OperationDesignatedOperatorTimeline.objects.create(
            operation=operation,
            operator=operation.operator,
            start_date = datetime(2024, 1, 1, tzinfo=ZoneInfo("UTC"))  # January 1, 2024
        )


class Migration(migrations.Migration):

    dependencies = [
        ('registration', '0095_document_status_historicaldocument_status'),
    ]

    operations = [
        migrations.RunPython(code=populate_operation_timeline_table_with_existing_data, reverse_code=migrations.RunPython.noop, elidable=True),
    ]
