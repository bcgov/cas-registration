# Generated by Django 5.1.15 on 2026-02-05 19:05

from decimal import Decimal
from django.db import migrations


def insert_lime_recovery_kiln_override(apps, schema_monitor):
    NaicsCode = apps.get_model('registration', 'NaicsCode')
    RegulatedProduct = apps.get_model('registration', 'RegulatedProduct')
    NaicsRegulatoryOverride = apps.get_model('reporting', 'NaicsRegulatoryOverride')

    lime_recovery_kiln_naics = NaicsCode.objects.get(naics_code='322112')
    lime_recovery_kiln_product = RegulatedProduct.objects.get(name='Pulp and paper: lime recovered by kiln')

    NaicsRegulatoryOverride.objects.create(
        naics_code=lime_recovery_kiln_naics,
        regulated_product=lime_recovery_kiln_product,
        reduction_factor=Decimal('0.9'),
        tightening_rate=Decimal('0.01'),
        valid_from='2025-01-01',
        valid_to='9999-12-31',
    )


def revert_lime_recovery_kiln_override(apps, schema_monitor):
    NaicsCode = apps.get_model('registration', 'NaicsCode')
    RegulatedProduct = apps.get_model('registration', 'RegulatedProduct')
    NaicsRegulatoryOverride = apps.get_model('reporting', 'NaicsRegulatoryOverride')

    lime_recovery_kiln_naics = NaicsCode.objects.get(naics_code='322112')
    lime_recovery_kiln_product = RegulatedProduct.objects.get(name='Pulp and paper: lime recovered by kiln')

    NaicsRegulatoryOverride.objects.filter(
        naics_code=lime_recovery_kiln_naics,
        regulated_product=lime_recovery_kiln_product,
        valid_from='2025-01-01',
        valid_to='9999-12-31',
    ).delete()


class Migration(migrations.Migration):

    dependencies = [
        ('reporting', '0153_create_naics_regulatory_override_table'),
    ]

    operations = [migrations.RunPython(insert_lime_recovery_kiln_override, revert_lime_recovery_kiln_override)]
